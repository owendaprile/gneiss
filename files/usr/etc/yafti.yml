---
title: Gneiss First Boot

properties:
  mode: "run-on-change"

screens:
  welcome-screen:
    source: yafti.screen.title
    values:
      title: "Welcome to Gneiss"
      description: |
        This tool will prepare the system with my preferred apps and settings

  remove-fedora-flatpaks:
    source: yafti.screen.consent
    values:
      title: Remove Fedora Flatpaks
      condition:
        run: flatpak remotes --columns=name | grep fedora
      description: |
        Would you like to remove the limited Fedora Flatpak remote and apps?
        Be careful, this step will remove all currently installed system Flatpaks!
      actions:
        - run: flatpak remote-modify --system --disable --force fedora
        - run: flatpak remote-modify --user --disable --force fedora
        - run: flatpak remote --system --noninteractive --all

  add-flathub-user:
    source: yafti.screen.consent
    values:
      title: Add Flathub
      description: |
        Would you like to add Flathub?
      condition:
        run: flatpak remotes --user --columns=name | grep flathub | wc -l | grep '^0$'
      actions:
        - run: flatpak remote-add --if-not-exists --user flathub https://flathub.org/repo/flathub.flatpakrepo

  install-flathub-apps:
    source: yafti.screen.package
    values:
      title: Install Flatpaks
      show_terminal: true
      package_manager: yafti.plugin.flatpak
      package_manager_defaults:
        user: true
        system: false
      groups:
        GNOME Core:
          description: Core GNOME apps
          packages:
            - Boxes: org.gnome.Boxes
            - Calculator: org.gnome.Calculator
            - Calendar: org.gnome.Calendar
            - Camera: org.gnome.Snapshot
            - Characters: org.gnome.Characters
            - Clocks: org.gnome.clocks
            - Connections: org.gnome.Connections
            - Contacts: org.gnome.Contacts
            - Document Viewer: org.gnome.Evince
            - Fonts: org.gnome.font-viewer
            - Image Viewer: org.gnome.Loupe
            - Text Editor: org.gnome.TextEditor
            - Weather: org.gnome.Weather
        GNOME Extra:
          description: Extra GNOME apps
          packages:
            - Amberol: io.bassi.Amberol
            - Celluloid: io.github.celluloid_player.Celluloid
            - Collision: dev.geopjr.Collision
            - Extension Manager: com.mattjakeman.ExtensionManager
            - Eyedropper: com.github.finefindus.eyedropper
            - Flatseal: com.github.tchx84.Flatseal
            - Impression: io.gitlab.adhami3310.Impression
        Gaming:
          description: Apps for "Gamers"
          packages:
            - Discord: com.discordapp.Discord
            - Heroic Games Launcher: com.heroicgameslauncher.hgl
            - itch: io.itch.itch
            - Steam: com.valvesoftware.Steam
        Entertainment:
          description: Music and video apps
          packages:
            - Plexamp: com.plexamp.Plexamp
            - Spotify: com.spotify.Client
            - Plex: tv.plex.PlexDesktop

  grub2-switch-to-blscfg:
    source: yafti.screen.consent
    values:
      title: Fix duplicate entries in bootloader
      description: |
        Stop duplicate entries from appearing on the boot screen
      actions:
        - run: pkexec grub2-switch-to-blscfg

  final:
    source: yafti.screen.title
    values:
      title: "All done!"
      description: |
        woohoo!